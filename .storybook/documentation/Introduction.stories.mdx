import { Meta } from '@storybook/addon-docs';

<Meta title="Documentation / Introduction" />

# Intoduction

This is the project from Nikon, all the frontend
code for this project is in the client folder. Nikon
sells all sorts of cameras and accessories and place
alot of importance on imagery. There are certain aspect
ratios which should be respected at all times, these
are documented in the [style guide](https://www.figma.com/proto/Nsdf8VyJ5TtQ7qRGbkMsKL/%E2%AD%90-Nikon-Design-System?page-id=2%3A14&node-id=41%3A10278&viewport=241%2C48%2C0.07&scaling=scale-down-width&starting-point-node-id=41%3A10278).

# Important links

- [Bitbucket Repo](https://bitbucket.org/buildingblocks/nikon-opti-dxp/src/develop/)

- [style guide](https://www.figma.com/proto/Nsdf8VyJ5TtQ7qRGbkMsKL/%E2%AD%90-Nikon-Design-System?page-id=2%3A14&node-id=41%3A10278&viewport=241%2C48%2C0.07&scaling=scale-down-width&starting-point-node-id=41%3A10278).
- [Design Sprints](<https://www.figma.com/file/zVt5JTVJOeP3Grimu8pkTW/%E2%AD%90-Nikon-Design-Sprints-(Roboto)?node-id=1333%3A409536>)
- [Jira](https://dept-uk.atlassian.net/jira/software/c/projects/NIKDD/boards/665)
- [Technical Specification](https://dept-uk.atlassian.net/wiki/spaces/clientnik/pages/8800623311436965349/33430+02+Technical+Specification)
- [Functional Specification](https://dept-uk.atlassian.net/wiki/spaces/clientnik/pages/8800623311436965764/08+Functional+Specification)

- [PreProd Environment](https://neub01mstroo05aprep.dxcloud.episerver.net/)
- [Integration Environment](https://neub01mstroo05ainte.dxcloud.episerver.net/)

# Tech used

This project is a hybrid approach of client side react Components
and sever side razor components. All components should be built in storybook
and then if razor, they should be migrated to the views folder using
razor syntax.

How do we determined if a component is React or Razor?

If a component has any interaction after the page has rendered then
it will have to be a react component, if a component needs a react package
like videos use react-player then it needs to be a react component.

We use storybook to develop everything. All endpoints that BE generate
shouldn't have cors issues on localhost and if they do then you **must**
send the component back to BE and instruct them to allow your localhost
in cors, we will not be developing by integrating with dotnet.

Styles are done via tailwind, this essentially uses classes for all styles.
Where ever possible we should be using tailwind or extending the config in
**tailwind.config.js**. Please see the section on styles for project specific
solutions.

# Project setup

## Prerequisites

- dotnet 5
- docker
- bitbucket repo cloned
- Node > 16.13.x

## Running the project In an Integrated environment

1. The very first step should be npm i in the client folder. And make sure your node
   is > 16.13.x. This can cause errors.

2. In terminal go to **data** folder and copy across all files in latest folder
   to **databases_nikon_opti/files/data** folder. Ensuring you remove or move files
   already in there.
3. In the **databases_nikon_opti** folder in the terminal run:

- docker-compose up

(This will create the images for docker and will start docker which we need for local integrated environment)

4. Go to **/src/Nikon.Opti.Web/client** folder and run:

   - npm run pack-dev

5. Go to **/src/Nikon.Opti.Web** folder and run:

   - dotnet run

   (If any dotnet errors a good thing to do in this folder is dotnet clean and dotnet restore. If this
   does not work and errors persist then try and contact a BE dev to help debug. **N.b.** you need the
   database running for the inetgration step of the workflow).

6. Nagigate to localhost ([https://localhost:8000/episerver/cms](https://localhost:8000/episerver/cms) or [https://localhost:8001/episerver/cms](https://localhost:8001/episerver/cms))
   ( ensuring /episerver/cms is on the path if you want cms access, please
   see cms section of the documentation to get a quick overview)

7. adding **?debug=serverjson** to the end of the url as a query param will allow you to view the json.
   Sometimes the json wont be present as it can bork the layout of the page so inspect the pre tags in the console.
   (Looking into with dan/cris)

# Running the project in Storybook

1. Go to **src/Nikon.Opti.Web/client** and run:

   - npm i
   - npm run storybook

   (N.B. If you have json with preprod or integration image absolute urls then looks to replace
   these in the json with image paths from **src/Nikon.Opti.Web/client/.storybook/images**, basically
   replacing https://neub01mstroo05ainte.dxcloud.episerver.net/image.png with /DSC05078.jpeg - which is
   located in the images folder in **.storybook** )

   Please see storybook section for further details on the workflow and development.

# Work flow

![Work flow diagram for FE on Nikon](/work-flow-diagram.drawio.png)

1. BE completes component from their perspective.
2. BE provides some example json either via a link to
   dev or writes on the FE ticket.
3. If json isnt ready or no example provided, unless nothing else
   to do, then hand back to BE for example JSON. Or do all the styling
   if blocked on everything.
4. When JSON example is ready then FE checks this first, if something is missing,
   then we hand it back to BE to amend or if minor carry on with the component. **N.B.** leaving
   a comment on the ticket.
   - JSON should be put on the FE ticket either by a BE dev or FE dev.
   - Link to integration environment with the component on a page should be put on ticket.
   - Link to Texh spec and Func spec should be somewhere on the ticket.
     (**VERY IMPORTANT** If no json or json isnt quite ready, do agree with BE dev on JSON
     structure and then begin your development in storybook)
5. Determine if Razor or React component.
6. Develop in Storybook for both types.
7. When dev checked in Storybook we either:
   - copy across code to razor template file in views folder
   - Carry on with react component workflow
8. Integrated via:
   - npm run pack-dev
   - dotnet run
   - dev check locally
9. After merging PR into develop we wait for the deployment to Integration
   and dev check on Integration.
10. Raise any none critical bugs. Or fix critical bugs.
11. Ready for QA.
12. handover to QA / Notes on Ticket

# Page Templates and Components

We have a set number of page templates detailed in the tech spec and then we have about 60
components we are building. We only have to concern ourselves with page templates that have a
a specific layout with the relatvent components. And some basic tailwind styling. Otherwise
the majority of our work is component based, we do **NOT** have a concept of page json in this
project for the frontend, a nuiance of this project.

Components will either be it:

**src/Nikon.Opti.Web/client/components**

or/

**src/Nikon.Opti.Web/Views**
